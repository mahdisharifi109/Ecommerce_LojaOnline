import{j as e}from"./vendor-ui-T5L2aXSd.js";import{r as f,e as L,L as N}from"./vendor-react-Dh4HNKln.js";import{a4 as O,a as R,t as I,i as M,l as V,P as $,B as h,L as l,I as o,v as w,a5 as B,A as G,r as U}from"./App-BJlSktNm.js";import{R as _,w as J,D as Q}from"./vendor-firebase-D4lSkuMt.js";import{M as H}from"./map-pin-lriVDexN.js";import{C}from"./credit-card-BCD-401b.js";import{L as P}from"./lock-DF-DvFPS.js";import{A as S}from"./arrow-left-BLP-Hjny.js";import{T as K}from"./truck-BosGbSEp.js";import"./index-Cd1_NYyQ.js";import"./vendor-charts-Czn4h1RS.js";var W=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],X=W.reduce((i,t)=>{const n=O(`Primitive.${t}`),c=f.forwardRef((x,u)=>{const{asChild:d,...p}=x,a=d?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(a,{...p,ref:u})});return c.displayName=`Primitive.${t}`,{...i,[t]:c}},{}),Y="Separator",F="horizontal",Z=["horizontal","vertical"],A=f.forwardRef((i,t)=>{const{decorative:n,orientation:c=F,...x}=i,u=ee(c)?c:F,p=n?{role:"none"}:{"aria-orientation":u==="vertical"?u:void 0,role:"separator"};return e.jsx(X.div,{"data-orientation":u,...p,...x,ref:t})});A.displayName=Y;function ee(i){return Z.includes(i)}var E=A;const g=f.forwardRef(({className:i,orientation:t="horizontal",decorative:n=!0,...c},x)=>e.jsx(E,{ref:x,decorative:n,orientation:t,className:R("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",i),...c}));g.displayName=E.displayName;function xe(){const{cartItems:i,subtotal:t,total:n,clearCart:c,isVerificationEnabled:x,verificationFee:u}=I(),{user:d}=M(),{toast:p}=V();L();const[a,v]=f.useState("shipping"),[b,y]=f.useState(!1),[s,D]=f.useState({fullName:(d==null?void 0:d.name)||"",email:(d==null?void 0:d.email)||"",address:"",city:"",zipCode:"",country:"Portugal",cardNumber:"",expiryDate:"",cvv:"",cardName:""}),m=r=>{const{name:j,value:T}=r.target;D(q=>({...q,[j]:T}))},k=r=>{if(r.preventDefault(),!s.address||!s.city||!s.zipCode){p({title:"Campos em falta",description:"Por favor preencha todos os campos de envio.",variant:"destructive"});return}v("payment"),window.scrollTo(0,0)},z=async r=>{if(r.preventDefault(),!s.cardNumber||!s.expiryDate||!s.cvv){p({title:"Dados de pagamento inválidos",description:"Por favor verifique os dados do seu cartão.",variant:"destructive"});return}y(!0);try{await new Promise(j=>setTimeout(j,2e3)),d&&await _(J(U,"orders"),{userId:d.uid,items:i,subtotal:t,total:n,shippingAddress:{fullName:s.fullName,address:s.address,city:s.city,zipCode:s.zipCode,country:s.country},status:"processing",createdAt:Q(),paymentMethod:"credit_card",isVerificationEnabled:x}),c(),v("confirmation"),window.scrollTo(0,0)}catch(j){console.error("Checkout error:",j),p({title:"Erro no processamento",description:"Ocorreu um erro ao processar o seu pedido. Por favor tente novamente.",variant:"destructive"})}finally{y(!1)}};return i.length===0&&a!=="confirmation"?e.jsxs("div",{className:"container mx-auto px-4 py-24 text-center",children:[e.jsx("div",{className:"mb-6 flex justify-center",children:e.jsx("div",{className:"rounded-full bg-muted p-6",children:e.jsx($,{className:"h-12 w-12 text-muted-foreground"})})}),e.jsx("h1",{className:"mb-2 text-2xl font-bold",children:"O seu carrinho está vazio"}),e.jsx("p",{className:"mb-8 text-muted-foreground",children:"Adicione alguns produtos antes de finalizar a compra."}),e.jsx(h,{asChild:!0,children:e.jsx(N,{to:"/catalog",children:"Ver Catálogo"})})]}):e.jsx("div",{className:"min-h-screen bg-background pb-20 pt-8",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs("div",{className:"mb-12 flex flex-col items-center justify-center space-y-4 md:flex-row md:space-y-0",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`flex h-8 w-8 items-center justify-center rounded-full text-sm font-bold ${a==="shipping"||a==="payment"||a==="confirmation"?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"}`,children:"1"}),e.jsx("span",{className:`ml-2 text-sm font-medium ${a==="shipping"?"text-foreground":"text-muted-foreground"}`,children:"Envio"})]}),e.jsx("div",{className:"mx-4 h-[2px] w-12 bg-border md:w-24"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`flex h-8 w-8 items-center justify-center rounded-full text-sm font-bold ${a==="payment"||a==="confirmation"?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"}`,children:"2"}),e.jsx("span",{className:`ml-2 text-sm font-medium ${a==="payment"?"text-foreground":"text-muted-foreground"}`,children:"Pagamento"})]}),e.jsx("div",{className:"mx-4 h-[2px] w-12 bg-border md:w-24"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`flex h-8 w-8 items-center justify-center rounded-full text-sm font-bold ${a==="confirmation"?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"}`,children:"3"}),e.jsx("span",{className:`ml-2 text-sm font-medium ${a==="confirmation"?"text-foreground":"text-muted-foreground"}`,children:"Confirmação"})]})]}),e.jsxs("div",{className:"grid gap-8 lg:grid-cols-12",children:[e.jsxs("div",{className:"lg:col-span-7 xl:col-span-8",children:[a==="shipping"&&e.jsxs("div",{className:"space-y-6 rounded-xl border bg-card p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 border-b pb-4",children:[e.jsx(H,{className:"h-5 w-5 text-primary"}),e.jsx("h2",{className:"text-xl font-semibold",children:"Morada de Envio"})]}),e.jsxs("form",{id:"shipping-form",onSubmit:k,className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"fullName",children:"Nome Completo"}),e.jsx(o,{id:"fullName",name:"fullName",value:s.fullName,onChange:m,placeholder:"João Silva",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"email",children:"Email"}),e.jsx(o,{id:"email",name:"email",type:"email",value:s.email,onChange:m,placeholder:"joao@exemplo.com",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"address",children:"Morada"}),e.jsx(o,{id:"address",name:"address",value:s.address,onChange:m,placeholder:"Rua Principal, nº 123, 1º Esq",required:!0})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"city",children:"Cidade"}),e.jsx(o,{id:"city",name:"city",value:s.city,onChange:m,placeholder:"Lisboa",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"zipCode",children:"Código Postal"}),e.jsx(o,{id:"zipCode",name:"zipCode",value:s.zipCode,onChange:m,placeholder:"1000-001",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"country",children:"País"}),e.jsx(o,{id:"country",name:"country",value:s.country,disabled:!0,className:"bg-muted"})]})]})]})]}),a==="payment"&&e.jsxs("div",{className:"space-y-6 rounded-xl border bg-card p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between border-b pb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{className:"h-5 w-5 text-primary"}),e.jsx("h2",{className:"text-xl font-semibold",children:"Pagamento Seguro"})]}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-green-600 bg-green-50 px-2 py-1 rounded-full",children:[e.jsx(P,{className:"h-3 w-3"}),"Encriptação SSL de 256-bits"]})]}),e.jsxs("form",{id:"payment-form",onSubmit:z,className:"space-y-6",children:[e.jsxs("div",{className:"rounded-lg border bg-muted/30 p-4",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx(l,{className:"text-base",children:"Cartão de Crédito / Débito"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"h-6 w-10 rounded bg-white shadow-sm"}),e.jsx("div",{className:"h-6 w-10 rounded bg-white shadow-sm"}),e.jsx("div",{className:"h-6 w-10 rounded bg-white shadow-sm"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"cardNumber",children:"Número do Cartão"}),e.jsxs("div",{className:"relative",children:[e.jsx(o,{id:"cardNumber",name:"cardNumber",value:s.cardNumber,onChange:m,placeholder:"0000 0000 0000 0000",className:"pl-10",required:!0}),e.jsx(C,{className:"absolute left-3 top-2.5 h-4 w-4 text-muted-foreground"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"expiryDate",children:"Validade (MM/AA)"}),e.jsx(o,{id:"expiryDate",name:"expiryDate",value:s.expiryDate,onChange:m,placeholder:"MM/AA",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"cvv",children:"CVV"}),e.jsx(o,{id:"cvv",name:"cvv",value:s.cvv,onChange:m,placeholder:"123",type:"password",maxLength:3,required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"cardName",children:"Nome no Cartão"}),e.jsx(o,{id:"cardName",name:"cardName",value:s.cardName,onChange:m,placeholder:"Como aparece no cartão",required:!0})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 rounded-md bg-blue-50 p-3 text-sm text-blue-700",children:[e.jsx(w,{className:"h-5 w-5 flex-shrink-0"}),e.jsx("p",{children:"O seu pagamento é processado de forma segura. Não guardamos os dados do seu cartão."})]})]})]}),a==="confirmation"&&e.jsxs("div",{className:"flex flex-col items-center justify-center space-y-6 rounded-xl border bg-card p-12 text-center shadow-sm",children:[e.jsx("div",{className:"flex h-20 w-20 items-center justify-center rounded-full bg-green-100",children:e.jsx(B,{className:"h-10 w-10 text-green-600"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-3xl font-bold",children:"Pagamento Confirmado!"}),e.jsxs("p",{className:"text-muted-foreground",children:["Obrigado pela sua compra. Enviámos um email de confirmação para ",s.email,"."]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(h,{variant:"outline",asChild:!0,children:e.jsx(N,{to:"/profile",children:"Ver as minhas compras"})}),e.jsx(h,{asChild:!0,children:e.jsx(N,{to:"/catalog",children:"Continuar a comprar"})})]})]}),a!=="confirmation"&&e.jsxs("div",{className:"mt-6 flex justify-between",children:[a==="payment"?e.jsxs(h,{variant:"outline",onClick:()=>v("shipping"),children:[e.jsx(S,{className:"mr-2 h-4 w-4"}),"Voltar"]}):e.jsx(h,{variant:"ghost",asChild:!0,children:e.jsxs(N,{to:"/catalog",children:[e.jsx(S,{className:"mr-2 h-4 w-4"}),"Continuar a comprar"]})}),a==="shipping"?e.jsxs(h,{type:"submit",form:"shipping-form",className:"px-8",children:["Continuar para Pagamento",e.jsx(G,{className:"ml-2 h-4 w-4"})]}):e.jsx(h,{type:"submit",form:"payment-form",className:"px-8",disabled:b,children:b?e.jsx(e.Fragment,{children:"A processar..."}):e.jsxs(e.Fragment,{children:["Pagar ",n.toFixed(2),"€",e.jsx(P,{className:"ml-2 h-4 w-4"})]})})]})]}),a!=="confirmation"&&e.jsx("div",{className:"lg:col-span-5 xl:col-span-4",children:e.jsxs("div",{className:"sticky top-24 rounded-xl border bg-card p-6 shadow-sm",children:[e.jsx("h3",{className:"mb-4 text-lg font-semibold",children:"Resumo do Pedido"}),e.jsx("div",{className:"mb-6 max-h-[300px] overflow-y-auto pr-2 space-y-4",children:i.map(r=>e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"h-16 w-16 flex-shrink-0 overflow-hidden rounded-md border bg-muted",children:e.jsx("img",{src:r.product.imageUrls[0],alt:r.product.name,className:"h-full w-full object-cover"})}),e.jsxs("div",{className:"flex flex-1 flex-col justify-center",children:[e.jsx("h4",{className:"text-sm font-medium line-clamp-1",children:r.product.name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Qtd: ",r.quantity]})]}),e.jsx("div",{className:"flex flex-col justify-center items-end",children:e.jsxs("span",{className:"text-sm font-medium",children:[(r.product.price*r.quantity).toFixed(2),"€"]})})]},r.id))}),e.jsx(g,{className:"my-4"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Subtotal"}),e.jsxs("span",{children:[t.toFixed(2),"€"]})]}),x&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Taxa de Verificação"}),e.jsxs("span",{children:[u.toFixed(2),"€"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Envio"}),e.jsx("span",{className:"text-green-600 font-medium",children:"Grátis"})]})]}),e.jsx(g,{className:"my-4"}),e.jsxs("div",{className:"flex justify-between text-lg font-bold",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:[n.toFixed(2),"€"]})]}),e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3 rounded-md bg-muted/50 p-3 text-xs text-muted-foreground",children:[e.jsx(K,{className:"h-4 w-4"}),e.jsx("span",{children:"Entrega estimada: 2-3 dias úteis"})]}),e.jsxs("div",{className:"flex items-center gap-3 rounded-md bg-muted/50 p-3 text-xs text-muted-foreground",children:[e.jsx(w,{className:"h-4 w-4"}),e.jsx("span",{children:"Garantia de reembolso de 30 dias"})]})]})]})})]})]})})}export{xe as default};
